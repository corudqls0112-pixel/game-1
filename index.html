<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>틀린그림찾기 퍼즐</title>
<style>
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    font-family: 'Comic Sans MS', cursive, sans-serif;
  }
  #game-container {
    position: relative;
    display: inline-block;
    margin-top: 20px;
  }
  #game-image {
    max-width: 800px;
    cursor: pointer;
    display: block;
  }
  .marker {
    position: absolute;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    pointer-events: none;
    transform: translate(-50%, -50%);
    font-size: 24px;
    font-weight: bold;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .correct {
    color: green;
  }
  .wrong {
    color: red;
  }
  #note {
    position: absolute;
    top: 20%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: #fff8dc;
    border: 2px solid #000;
    padding: 15px;
    border-radius: 10px;
    font-family: 'Bradley Hand', 'Comic Sans MS', cursive;
    display: none;
    z-index: 10;
    text-align: center;
  }
</style>
</head>
<body>
<h2>틀린그림을 찾아보세요! (총 6개)</h2>

<!-- 이미지 업로드 -->
<input type="file" id="image-upload" accept="image/숨은그림찾기.png">
<div id="game-container">
  <img id="game-image" src="" alt="틀린그림찾기" style="display:none;">
  <div id="note">퍼즐 조각 하나는 의자 밑에 있습니다.</div>
</div>

<script>
const gameImage = document.getElementById('game-image');
const gameContainer = document.getElementById('game-container');
const note = document.getElementById('note');
const imageUpload = document.getElementById('image-upload');

// 틀린 그림 위치 (x, y 비율 기준, 예시)
const wrongSpots = [
  {x: 0.15, y: 0.2},
  {x: 0.35, y: 0.3},
  {x: 0.55, y: 0.25},
  {x: 0.25, y: 0.6},
  {x: 0.65, y: 0.5},
  {x: 0.8, y: 0.7}
];
const tolerance = 0.05;
let foundSpots = Array(wrongSpots.length).fill(false);

// 이미지 업로드 처리
imageUpload.addEventListener('change', (e) => {
  const file = e.target.files[0];
  if (!file) return;

  const reader = new FileReader();
  reader.onload = function(event) {
    gameImage.src = event.target.result;
    gameImage.style.display = 'block';
  }
  reader.readAsDataURL(file);
});

// 클릭 이벤트
gameImage.addEventListener('click', (e) => {
  const rect = gameImage.getBoundingClientRect();
  const clickX = (e.clientX - rect.left) / rect.width;
  const clickY = (e.clientY - rect.top) / rect.height;

  let foundIndex = -1;
  wrongSpots.forEach((spot, index) => {
    if (!foundSpots[index] &&
        Math.abs(clickX - spot.x) < tolerance &&
        Math.abs(clickY - spot.y) < tolerance) {
      foundIndex = index;
    }
  });

  const marker = document.createElement('div');
  marker.classList.add('marker');
  marker.style.left = e.offsetX + 'px';
  marker.style.top = e.offsetY + 'px';

  if (foundIndex !== -1) {
    marker.classList.add('correct');
    marker.textContent = '⭕';
    foundSpots[foundIndex] = true;

    if (foundSpots.every(v => v)) {
      note.style.display = 'block';
    }
  } else {
    marker.classList.add('wrong');
    marker.textContent = '❌';
  }

  gameContainer.appendChild(marker);
});
</script>
</body>
</html>
